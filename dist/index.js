"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let s=document.querySelector("#devBtn"),u=document.querySelector("#subBtn"),S=document.querySelector("#lat"),w=document.querySelector("#lng"),o=L.map("map").setView([44.96193,-93.19876],12);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(o);let v=L.icon({iconUrl:"https://img.icons8.com/fluency-systems-filled/512/school-building.png",iconSize:[30,30],iconAnchor:[15,15]});L.marker([44.962242019810816,-93.19836196172906],{icon:v}).addTo(o).bindPopup("This is Avalon!").openPopup();let p=new Headers;p.append("Authorization","Bearer patrAJ8JGjXuGM2q1.42e1c29a4f18aa9bf9e192c82814e74e5d2ab9baae5543eb1d12f422d6461f02"),p.append("Cookie","brw=brwZvTCExMDX59gu8; AWSALB=y7aNExO+naIhJIQyRw6Fmi5UQZ1FRtVbaK4C50umFSJUV9ime2OaTRDvhbM1ZSWQu1P4kS4h9ai8pJUMZuPStOYw+AaBSTUUSnh4k2r+kyYgMhg6ITuMpB3Qd65K; AWSALBCORS=y7aNExO+naIhJIQyRw6Fmi5UQZ1FRtVbaK4C50umFSJUV9ime2OaTRDvhbM1ZSWQu1P4kS4h9ai8pJUMZuPStOYw+AaBSTUUSnh4k2r+kyYgMhg6ITuMpB3Qd65K"),fetch("https://api.airtable.com/v0/appFU39SABmXIlZRs/tblYQ1DRIwpTLLUWS",{method:"GET",headers:p,redirect:"follow"}).then(e=>e.json()).then(e=>e.records).then(e=>{e.forEach(n=>{let{Name:c,contact:r,Lat:l,Lng:d,preference:m}=n.fields,h=Number(l),i=Number(d);L.marker([h,i],{title:c,riseOnHover:!0}).addTo(o).addTo(o).bindPopup(`<b>Family:</b> ${c}<br><b>Contact:</b> ${r}<br><br><b>Preference:</b><br> ${m}`)})}).catch(e=>console.log("error",e));let t;o.once("click",function(e){let n=L.icon({iconUrl:"https://img.icons8.com/doodle/512/filled-flag.png",iconSize:[20,20],iconAnchor:[10,-5]});t=L.marker([e.latlng.lat,e.latlng.lng],{draggable:!0,icon:n}).addTo(o),o.setView(t.getLatLng(),14),t.bindPopup("Drag your flag to wherever you want,<br>and then submit the form below").openPopup()}),s==null||s.addEventListener("click",function(){let{lat:e,lng:n}=t.getLatLng();S.value=e,w.value=n;let c=L.icon({iconUrl:"https://static.wixstatic.com/media/c4450c_168cf5fbfc1b4ff5b175236c985a3086~mv2.png",iconSize:[30,30],iconAnchor:[15,15]});t.setIcon(c),o.setView(t.getLatLng(),13),t.bindPopup("This is you!<br>Explore the map to connect!").openPopup()}),u==null||u.addEventListener("click",function(){var i,b,g,y,f;let e=(i=document.querySelector("#name"))==null?void 0:i.value,n=(b=document.querySelector("#lat"))==null?void 0:b.value,c=(g=document.querySelector("#lng"))==null?void 0:g.value,r=(y=document.querySelector("#preference"))==null?void 0:y.value,l=(f=document.querySelector("#contact"))==null?void 0:f.value,d=document.querySelector("#permissionBox").checked,m=document.querySelector("#mapBox").checked,h=new Date(Date.now()).toLocaleString();if(e&&r&&l&&d===!0&&m===!0){let k={method:"POST",headers:{accept:"application/json","content-type":"application/json",authorization:"Bearer patrAJ8JGjXuGM2q1.42e1c29a4f18aa9bf9e192c82814e74e5d2ab9baae5543eb1d12f422d6461f02"},body:JSON.stringify({fields:{Name:e,contact:l,preference:r,slug:e,Lat:n,Lng:c,Status:"Active",date:h}})};fetch("https://api.airtable.com/v0/appFU39SABmXIlZRs/tblYQ1DRIwpTLLUWS",k).then(a=>a.json()).then(a=>console.log(a)).catch(a=>console.error(a)),document.querySelector("#name").value="",document.querySelector("#contact").value="",document.querySelector("#preference").value="",document.querySelector("#permissionBox").checked=!1,document.querySelector("#mapBox").checked=!1,document.getElementById("submission-thanks").style.display="flex",document.querySelector("#subBtn").style.display="none"}else console.log("something dind't work you fool")})});})();
