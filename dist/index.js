"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let d=document.querySelector("#devBtn"),y=document.querySelector("#devText"),o=L.map("map").setView([44.96193,-93.19876],12);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(o);let m=new Headers;m.append("Authorization","Bearer patrAJ8JGjXuGM2q1.42e1c29a4f18aa9bf9e192c82814e74e5d2ab9baae5543eb1d12f422d6461f02"),m.append("Cookie","brw=brwZvTCExMDX59gu8; AWSALB=y7aNExO+naIhJIQyRw6Fmi5UQZ1FRtVbaK4C50umFSJUV9ime2OaTRDvhbM1ZSWQu1P4kS4h9ai8pJUMZuPStOYw+AaBSTUUSnh4k2r+kyYgMhg6ITuMpB3Qd65K; AWSALBCORS=y7aNExO+naIhJIQyRw6Fmi5UQZ1FRtVbaK4C50umFSJUV9ime2OaTRDvhbM1ZSWQu1P4kS4h9ai8pJUMZuPStOYw+AaBSTUUSnh4k2r+kyYgMhg6ITuMpB3Qd65K"),fetch("https://api.airtable.com/v0/appFU39SABmXIlZRs/tblYQ1DRIwpTLLUWS",{method:"GET",headers:m,redirect:"follow"}).then(e=>e.json()).then(e=>e.records).then(e=>{e.forEach(c=>{let{Name:n,contact:r,Lat:i,Lng:s,preference:u}=c.fields,l=Number(i),p=Number(s);L.marker([l,p],{title:n,riseOnHover:!0}).addTo(o).addTo(o).bindPopup(`<b>Family:</b> ${n}<br><b>Contact:</b> ${r}<br><br><b>Preference:</b><br> ${u}`)})}).catch(e=>console.log("error",e));let t;o.once("click",function(e){let c=L.icon({iconUrl:"https://img.icons8.com/doodle/512/filled-flag.png",iconSize:[20,20],iconAnchor:[10,10]});t=L.marker([e.latlng.lat,e.latlng.lng],{draggable:!0,icon:c}).addTo(o),o.setView(t.getLatLng()),t.bindPopup("Drag your flag to wherever you want,<br>and then submit the form below").openPopup()}),d==null||d.addEventListener("click",function(){var p,h,b;let{lat:e,lng:c}=t.getLatLng(),n=(p=document.querySelector("#name"))==null?void 0:p.value,r=(h=document.querySelector("#preference"))==null?void 0:h.value,i=(b=document.querySelector("#contact"))==null?void 0:b.value,s=document.querySelector("#permissionBox").checked,u=document.querySelector("#mapBox").checked,l=new Date(Date.now()).toLocaleString();if(console.log(l,s),n&&r&&i&&s===!0&&u===!0){console.log("Ready to go");let f={method:"POST",headers:{accept:"application/json","content-type":"application/json",authorization:"Bearer patrAJ8JGjXuGM2q1.42e1c29a4f18aa9bf9e192c82814e74e5d2ab9baae5543eb1d12f422d6461f02"},body:JSON.stringify({fields:{Name:n,contact:i,preference:r,slug:n,Lat:`${e.toString()}`,Lng:`${c.toString()}`,Status:"Active",date:l}})};fetch("https://api.airtable.com/v0/appFU39SABmXIlZRs/tblYQ1DRIwpTLLUWS",f).then(a=>a.json()).then(a=>console.log(a)).catch(a=>console.error(a));let S=L.icon({iconUrl:"https://static.wixstatic.com/media/c4450c_168cf5fbfc1b4ff5b175236c985a3086~mv2.png",iconSize:[20,20],iconAnchor:[15,-10]});t.setIcon(S),o.setView(t.getLatLng(),13),t.bindPopup("This is you!<br>Explore the map to connect!").openPopup();let w=document.querySelector("#mapZoom").offsetTop;window.scrollTo(0,w)}else console.log("something dind't work")});let g=L.icon({iconUrl:"https://img.icons8.com/fluency-systems-filled/512/school-building.png",iconSize:[30,30],iconAnchor:[15,15]});L.marker([44.962242019810816,-93.19836196172906],{icon:g}).addTo(o).bindPopup("This is Avalon!"),console.log("MANIAC YOU ? You1")});})();
