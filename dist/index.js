"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let d=document.querySelector("#devBtn"),p=document.querySelector("#subBtn"),q=document.querySelector("#devText"),y=document.querySelector("#lat"),w=document.querySelector("#lng"),o=L.map("map").setView([44.96193,-93.19876],12);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(o);let m=new Headers;m.append("Authorization","Bearer patrAJ8JGjXuGM2q1.42e1c29a4f18aa9bf9e192c82814e74e5d2ab9baae5543eb1d12f422d6461f02"),m.append("Cookie","brw=brwZvTCExMDX59gu8; AWSALB=y7aNExO+naIhJIQyRw6Fmi5UQZ1FRtVbaK4C50umFSJUV9ime2OaTRDvhbM1ZSWQu1P4kS4h9ai8pJUMZuPStOYw+AaBSTUUSnh4k2r+kyYgMhg6ITuMpB3Qd65K; AWSALBCORS=y7aNExO+naIhJIQyRw6Fmi5UQZ1FRtVbaK4C50umFSJUV9ime2OaTRDvhbM1ZSWQu1P4kS4h9ai8pJUMZuPStOYw+AaBSTUUSnh4k2r+kyYgMhg6ITuMpB3Qd65K"),fetch("https://api.airtable.com/v0/appFU39SABmXIlZRs/tblYQ1DRIwpTLLUWS",{method:"GET",headers:m,redirect:"follow"}).then(e=>e.json()).then(e=>e.records).then(e=>{e.forEach(t=>{let{Name:c,contact:a,Lat:r,Lng:l,preference:h}=t.fields,i=Number(r),u=Number(l);L.marker([i,u],{title:c,riseOnHover:!0}).addTo(o).addTo(o).bindPopup(`<b>Family:</b> ${c}<br><b>Contact:</b> ${a}<br><br><b>Preference:</b><br> ${h}`)})}).catch(e=>console.log("error",e));let n;o.once("click",function(e){let t=L.icon({iconUrl:"https://img.icons8.com/doodle/512/filled-flag.png",iconSize:[20,20],iconAnchor:[10,10]});n=L.marker([e.latlng.lat,e.latlng.lng],{draggable:!0,icon:t}).addTo(o),o.setView(n.getLatLng()),n.bindPopup("Drag your flag to wherever you want,<br>and then submit the form below").openPopup()}),d==null||d.addEventListener("click",function(){let{lat:e,lng:t}=n.getLatLng();y.value=e,w.value=t;let c=L.icon({iconUrl:"https://static.wixstatic.com/media/c4450c_168cf5fbfc1b4ff5b175236c985a3086~mv2.png",iconSize:[20,20],iconAnchor:[15,-10]});n.setIcon(c),console.log("Ready to go")}),p==null||p.addEventListener("click",function(){var u,g,b,S,f;let e=(u=document.querySelector("#name"))==null?void 0:u.value,t=(g=document.querySelector("#lat"))==null?void 0:g.value,c=(b=document.querySelector("#lng"))==null?void 0:b.value,a=(S=document.querySelector("#preference"))==null?void 0:S.value,r=(f=document.querySelector("#contact"))==null?void 0:f.value,l=document.querySelector("#permissionBox").checked,h=document.querySelector("#mapBox").checked,i=new Date(Date.now()).toLocaleString();if(console.log(e,a,r,t,c,l),o.setView(n.getLatLng(),13),n.bindPopup("This is you!<br>Explore the map to connect!").openPopup(),console.log(i,l),e&&a&&r&&l===!0&&h===!0){let v={method:"POST",headers:{accept:"application/json","content-type":"application/json",authorization:"Bearer patrAJ8JGjXuGM2q1.42e1c29a4f18aa9bf9e192c82814e74e5d2ab9baae5543eb1d12f422d6461f02"},body:JSON.stringify({fields:{Name:e,contact:r,preference:a,slug:e,Lat:t,Lng:c,Status:"Active",date:i}})};fetch("https://api.airtable.com/v0/appFU39SABmXIlZRs/tblYQ1DRIwpTLLUWS",v).then(s=>s.json()).then(s=>console.log(s)).catch(s=>console.error(s)),document.querySelector("#name").value="",document.querySelector("#contact").value="",document.querySelector("#preference").value="",document.querySelector("#permissionBox").checked=!1,document.querySelector("#mapBox").checked=!1,document.getElementById("submission-thanks").style.display="flex",console.log("CLEARED")}else console.log("something dind't work")})});})();
